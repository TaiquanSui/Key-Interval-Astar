# Preprocess 测试说明

本目录包含用于测试 `Preprocess` 类的 Google Test 文件。

## 测试文件

1. **PreprocessTest.cpp** - 基础功能测试
   - 测试构造函数和地图尺寸
   - 测试空地图、简单地图、复杂地图的预处理
   - 测试关键点提取、邻居关系、transition vertices
   - 测试边界情况

2. **PreprocessDetailedTest.cpp** - 详细功能测试
   - 测试L形障碍物、走廊、迷宫等特定地图
   - 测试关键点方向标记的正确性
   - 测试邻居关系的对称性
   - 测试区间坐标的有效性
   - 测试性能（大地图处理）

## 构建和运行测试

### 构建测试
```bash
mkdir build
cd build
cmake ..
make
```

### 运行基础测试
```bash
./bin/preprocess_test
```

### 运行详细测试
```bash
./bin/preprocess_detailed_test
```

### 运行所有测试
```bash
make test
```

## 测试覆盖范围

### 基础功能测试
- ✅ 构造函数和地图尺寸获取
- ✅ 空地图预处理
- ✅ 简单地图预处理
- ✅ 复杂地图预处理
- ✅ 关键点提取
- ✅ 邻居关系构建
- ✅ transition vertices
- ✅ findKeyInterval方法
- ✅ 边界情况处理

### 详细功能测试
- ✅ L形障碍物关键点提取
- ✅ 走廊地图区间划分
- ✅ 迷宫地图复杂结构
- ✅ 关键点方向标记
- ✅ 邻居关系对称性
- ✅ 区间坐标有效性
- ✅ Key Interval唯一性
- ✅ 大地图性能测试

## 测试地图说明

### 基础测试地图
- **空地图**: 8x8全为0的地图
- **简单地图**: 8x8地图，中间有2x2障碍物
- **复杂地图**: 8x8地图，多个障碍物

### 详细测试地图
- **L形地图**: 包含L形障碍物的地图
- **走廊地图**: 包含水平走廊的地图
- **迷宫地图**: 简单的迷宫结构

## 注意事项

1. 某些测试（如transition vertices）可能因为具体实现细节而失败，这是正常的
2. 性能测试主要用于确保算法不会崩溃，时间阈值可能需要根据具体硬件调整
3. 测试输出包含调试信息，可以帮助理解算法的行为

## 添加新测试

要添加新的测试用例：

1. 在相应的测试文件中添加新的 `TEST_F` 函数
2. 如果需要新的测试地图，在 `SetUp()` 方法中添加
3. 重新构建并运行测试

## 故障排除

如果测试失败：

1. 检查 `Preprocess` 类的实现是否正确
2. 查看测试输出中的调试信息
3. 确认地图数据格式正确（0表示可通行，1表示障碍物）
4. 检查CMake配置是否正确 